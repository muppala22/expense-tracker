<!-- expense-form.html - IMPROVED VERSION -->
<div class="expense-form-wrapper">
  <div class="expense-form-container">
    <div class="form-header">
      <div class="header-icon">
        <mat-icon>{{ isEditMode() ? 'edit' : 'add_circle' }}</mat-icon>
      </div>
      <div class="header-content">
        <h2>{{ isEditMode() ? 'Edit Expense' : 'Add New Expense' }}</h2>
        <p class="form-subtitle">{{ isEditMode() ? 'Update your expense details' : 'Track your spending' }}</p>
      </div>
    </div>

    <div class="expense-form">
      <div class="form-fields">

        <!-- Title Field -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Expense Title</mat-label>
          <mat-icon matPrefix>title</mat-icon>
          <input matInput [formControl]="form.controls.title" placeholder="e.g., Grocery shopping"/>
          @if (form.controls.title.hasError('required') && form.controls.title.touched) {
            <mat-error>Title is required</mat-error>
          }
        </mat-form-field>

        <!-- Amount and Category Row -->
        <div class="form-row">
          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Amount</mat-label>
            <span matPrefix>$&nbsp;</span>
            <input matInput type="number" step="0.01" [formControl]="form.controls.amount" placeholder="0.00"/>
            @if (form.controls.amount.hasError('required') && form.controls.amount.touched) {
              <mat-error>Amount is required</mat-error>
            }
            @if (form.controls.amount.hasError('min')) {
              <mat-error>Amount must be positive</mat-error>
            }
          </mat-form-field>

          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Category</mat-label>
            <mat-icon matPrefix>category</mat-icon>
            <mat-select [formControl]="form.controls.category">
              <mat-option value="Food">
                <mat-icon class="option-icon food">restaurant</mat-icon>
                Food
              </mat-option>
              <mat-option value="Transport">
                <mat-icon class="option-icon transport">directions_car</mat-icon>
                Transport
              </mat-option>
              <mat-option value="Utilities">
                <mat-icon class="option-icon utilities">build</mat-icon>
                Utilities
              </mat-option>
              <mat-option value="Entertainment">
                <mat-icon class="option-icon entertainment">movie</mat-icon>
                Entertainment
              </mat-option>
              <mat-option value="Shopping">
                <mat-icon class="option-icon shopping">shopping_bag</mat-icon>
                Shopping
              </mat-option>
              <mat-option value="Other">
                <mat-icon class="option-icon other">more_horiz</mat-icon>
                Other
              </mat-option>
            </mat-select>
            @if (form.controls.category.hasError('required') && form.controls.category.touched) {
              <mat-error>Category is required</mat-error>
            }
          </mat-form-field>
        </div>

        <!-- Date Field -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Date</mat-label>
          <mat-icon matPrefix>event</mat-icon>
          <input matInput type="date" [formControl]="form.controls.date" />
          @if (form.controls.date.hasError('required') && form.controls.date.touched) {
            <mat-error>Date is required</mat-error>
          }
        </mat-form-field>

        <!-- Form Preview Card -->
        @if (form.valid) {
          <div class="preview-card">
            <div class="preview-header">
              <mat-icon>visibility</mat-icon>
              <span>Preview</span>
            </div>
            <div class="preview-content">
              <div class="preview-item">
                <span class="preview-label">Title:</span>
                <span class="preview-value">{{ form.value.title }}</span>
              </div>
              <div class="preview-item">
                <span class="preview-label">Amount:</span>
                <span class="preview-value amount">{{ form.value.amount | currency }}</span>
              </div>
              <div class="preview-item">
                <span class="preview-label">Category:</span>
                <span class="preview-value">{{ form.value.category }}</span>
              </div>
              <div class="preview-item">
                <span class="preview-label">Date:</span>
                <span class="preview-value">{{ form.value.date | date:'MMM d, y' }}</span>
              </div>
            </div>
          </div>
        }

        <!-- Action Buttons -->
        <div class="actions">
          <button mat-stroked-button type="button" routerLink="/expenses" class="cancel-button">
            <mat-icon>close</mat-icon>
            Cancel
          </button>
          <button mat-raised-button color="primary" type="button" (click)="save()" [disabled]="form.invalid" class="save-button">
            <mat-icon>{{ isEditMode() ? 'update' : 'save' }}</mat-icon>
            {{ isEditMode() ? 'Update Expense' : 'Save Expense' }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
