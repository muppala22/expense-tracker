<!-- expense-list.html - IMPROVED VERSION -->
<div class="expense-list-container">
  <div class="header-section">
    <div class="header-content">
      <h2>My Expenses</h2>
      <p class="subtitle">Track and manage your spending</p>
    </div>
    <button mat-raised-button color="primary" routerLink="/expenses/new" class="add-button">
      <mat-icon>add</mat-icon>
      Add Expense
    </button>
  </div>

  <!-- Summary Cards -->
  @if (showTable()) {
    <div class="summary-cards">
      <div class="summary-card total-card">
        <div class="card-icon">
          <mat-icon>account_balance_wallet</mat-icon>
        </div>
        <div class="card-content">
          <span class="card-label">Total Expenses</span>
          <span class="card-value">{{ getTotalExpenses() | currency }}</span>
          <span class="card-info">{{ expenses().length }} transactions</span>
        </div>
      </div>

      <div class="summary-card average-card">
        <div class="card-icon">
          <mat-icon>trending_up</mat-icon>
        </div>
        <div class="card-content">
          <span class="card-label">Average</span>
          <span class="card-value">{{ getAverageExpense() | currency }}</span>
          <span class="card-info">per transaction</span>
        </div>
      </div>

      <div class="summary-card highest-card">
        <div class="card-icon">
          <mat-icon>show_chart</mat-icon>
        </div>
        <div class="card-content">
          <span class="card-label">Highest</span>
          <span class="card-value">{{ getHighestExpense() | currency }}</span>
          <span class="card-info">single expense</span>
        </div>
      </div>
    </div>

    <!-- Search and Filter Bar -->
    <div class="filter-section">
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Search expenses</mat-label>
        <input matInput [(ngModel)]="searchTerm" placeholder="Search by title...">
        <mat-icon matPrefix>search</mat-icon>
      </mat-form-field>

      <mat-form-field appearance="outline" class="filter-field">
        <mat-label>Filter by category</mat-label>
        <mat-select [(ngModel)]="selectedCategory">
          <mat-option value="">All Categories</mat-option>
          <mat-option value="Food">Food</mat-option>
          <mat-option value="Transport">Transport</mat-option>
          <mat-option value="Utilities">Utilities</mat-option>
          <mat-option value="Entertainment">Entertainment</mat-option>
          <mat-option value="Shopping">Shopping</mat-option>
          <mat-option value="Other">Other</mat-option>
        </mat-select>
        <mat-icon matPrefix>filter_list</mat-icon>
      </mat-form-field>
    </div>

    <!-- Expenses Table -->
    <div class="table-container">
      <table mat-table [dataSource]="filteredExpenses()" class="expense-table mat-elevation-z2">

        <ng-container matColumnDef="title">
          <th mat-header-cell *matHeaderCellDef>
            <div class="header-cell">
              <mat-icon class="header-icon">title</mat-icon>
              Title
            </div>
          </th>
          <td mat-cell *matCellDef="let e">
            <a [routerLink]="['/expenses', e.id]" class="expense-link">
              <span class="expense-title">{{ e.title }}</span>
            </a>
          </td>
        </ng-container>

        <ng-container matColumnDef="category">
          <th mat-header-cell *matHeaderCellDef>
            <div class="header-cell">
              <mat-icon class="header-icon">category</mat-icon>
              Category
            </div>
          </th>
          <td mat-cell *matCellDef="let e">
            <span class="category-badge" [attr.data-category]="e.category">
              {{ e.category }}
            </span>
          </td>
        </ng-container>

        <ng-container matColumnDef="amount">
          <th mat-header-cell *matHeaderCellDef>
            <div class="header-cell">
              <mat-icon class="header-icon">attach_money</mat-icon>
              Amount
            </div>
          </th>
          <td mat-cell *matCellDef="let e">
            <span class="amount-value">{{ e.amount | currency }}</span>
          </td>
        </ng-container>

        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef>
            <div class="header-cell">
              <mat-icon class="header-icon">event</mat-icon>
              Date
            </div>
          </th>
          <td mat-cell *matCellDef="let e">
            <span class="date-value">{{ e.date | date:'MMM d, y' }}</span>
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> Actions </th>
          <td mat-cell *matCellDef="let e">
            <div class="action-buttons">
              <button mat-icon-button color="primary" [routerLink]="['/expenses', e.id, 'edit']" matTooltip="Edit expense">
                <mat-icon>edit</mat-icon>
              </button>

              <button mat-icon-button color="warn" (click)="delete(e)" matTooltip="Delete expense">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="expense-row"></tr>

      </table>
    </div>
  } @else {
    <div class="empty-state">
      <div class="empty-icon-wrapper">
        <mat-icon class="empty-icon">receipt_long</mat-icon>
      </div>
      <h3>No expenses yet</h3>
      <p>Start tracking your expenses by adding your first transaction</p>
      <button mat-raised-button color="primary" routerLink="/expenses/new" class="empty-state-button">
        <mat-icon>add</mat-icon>
        Add Your First Expense
      </button>
    </div>
  }
</div>
